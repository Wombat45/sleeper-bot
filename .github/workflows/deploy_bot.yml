name: Deploy Discord Bot
on:
  push:
    paths:
      - 'bot/**'
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Build and push to Digital Ocean Registry
        env:
          DO_REGISTRY_TOKEN: ${{ secrets.DO_REGISTRY_TOKEN }}
        run: |
          cd bot
          docker login registry.digitalocean.com -u ${{ secrets.DO_REGISTRY_TOKEN }} -p ${{ secrets.DO_REGISTRY_TOKEN }}
          docker build -t registry.digitalocean.com/your-registry/discord-bot:latest .
          docker push registry.digitalocean.com/your-registry/discord-bot:latest
      - name: Deploy to App Platform
        uses: digitalocean/app-action@v1
        with:
          app_name: discord-bot
          token: ${{ secrets.DO_APP_PLATFORM_TOKEN }}